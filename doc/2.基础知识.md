# jsx

> React 不强制要求使用 JSX，但是大多数人发现，在 JavaScript 代码中将 JSX 和 UI 放在一起时，会在视觉上有辅助作用。它还可以使 React 显示更多有用的错误和警告消息。

## 语法

### 嵌入表达式 

```jsx
  const  element = <h1>计算结果：{{a+b}}</h1>;

  ReactDOM.render(element,document.getElementById('root'))
```

### JSX 也是一个表达式 【支持if for 等语句】

```jsx
  const  element = (a,b)=>{
    if(!a&&!b){
      return <h1>计算结果：{{a+b}}</h1>;
    }
    return <h1>还没有值，无法计算</h1>；
  };
  ReactDOM.render(element(1,2), document.getElementById('root'));
```

### JSX 指定子元素 表示清晰的逻辑层级

```jsx
  const element = (
    <div>
      <h1>Hello!</h1>
      <h2>Good to see you here.</h2>
    </div>
  );
```

### 特定属性

1. class 换成 calssName
2. 各种属性驼峰写法 如：tabIndex
3. 属性接受字符串或者 javascript 对象[那几种数据类型]
```jsx
  const title='Good to see you here';
  const element = (
    <div>
      <h1 className="box-title">Hello!</h1>
      <h2 title={title} data={{}}>Good to see you here.</h2>
    </div>
  );
```

### JSX 防止注入攻击
>React DOM 在渲染所有输入内容之前，默认会进行转义。它可以确保在你的应用中，永远不会注入那些并非自己明确编写的内容。所有的内容在渲染之前都被转换成了字符串。这样可以有效地防止 XSS（cross-site-scripting, 跨站脚本）攻击

### JSX 表示对象
Babel 会把 JSX 转译成一个名为 React.createElement() 函数调用

```js
  // jsx
  const element = (
    <h1 className="text-center">
      Hello, world!
    </h1>
  );
  // createElement 等效代码

  const element= React.createElement('h1',{className:'text-center'},'Hello, world!');

  // 转译后
  const element = {
  type: 'h1',
  props: {
    className: 'text-center',
    children: 'Hello, world!'
  }
};

```

# 组件 & Props

## 定义组件

### 函数方式

```js
  function Welcome (){
    return <h1>hell,{props.name}</h1>
  };
  // or es6 箭头函数
  const Welcome =(props)=>{
    return <h1>hell,{props.name}</h1>
  }

```

### ES6的class方式

```js
  class Welcome extends React.Component{
    render (){
      return <h1>hell,{props.name}</h1>
    }
  }

```

### 组件使用

```js
  const element = <Welcome name="Sara" />;
  ReactDOM.render(
    element,
    document.getElementById('root')
  );
```

> 组件名称必须以大写字母开头。小写会被认为是原生 DOM 标签。
[详情查看](https://zh-hans.reactjs.org/docs/jsx-in-depth.html#user-defined-components-must-be-capitalized)

### 组合组件

```js
  function app (){
    return (
      <>
        <Welcome name="McDowell" />;
        <Welcome name="Dava" />;
        <Welcome name="Cahal" />;
      </>
      /*
      // 等同于
      <div>
        <Welcome name="McDowell" />;
        <Welcome name="Dava" />;
        <Welcome name="Cahal" />;
      </div>
      */
    )
  };
  ReactDOM.render(
    element,
    document.getElementById('root')
  );
```

### Props 的只读性

> 组件无论是使用函数声明还是通过 class 声明，都决不能修改自身的 props.
> 所有 React 组件都必须像纯函数一样保护它们的 props 不被更改。

# State & 生命周期

## 重写开始示例

```js
  function Clock(props) {
    return (
      <div>
        <h1>Hello, world!</h1>
        <h2>It is {props.date.toLocaleTimeString()}.</h2>
      </div>
    );
  }

  function tick() {
    ReactDOM.render(
      <Clock date={new Date()} />,
      document.getElementById('root')
    );
  }

  setInterval(tick, 1000);

```

## 在 class 中使用 state

- 改写为 class组件

```js

  class Clock extends React.Component{
    render(){
      return (
      <div>
        <h1>Hello, world!</h1>
        <h2>It is {this.props.date.toLocaleTimeString()}.</h2>
      </div>
    );
    }
  }

  function tick() {
    ReactDOM.render(
      <Clock date={new Date()} />,
      document.getElementById('root')
    );
  }

  setInterval(tick, 1000);

```

- 改为使用state方式

```js
  class Clock extends React.Component{
    constructor(props){
      super(props);
      this.state={
        date:new Date()
      }

    }

    render (){
      return (
      <div>
        <h1>Hello, world!</h1>
        <h2>It is {this.state.date.toLocaleTimeString()}.</h2>
      </div>
      )
    }
  }

  function tick() {
    ReactDOM.render(
      <Clock />,
      document.getElementById('root')
    );
  }

  setInterval(tick, 1000);
```

- 使用生命周期

```js
  class Clock extends React.Component{
    constructor(props){
      super(props);
      this.timer=null;
      this.state={
        date:new Date()
      }

    }

    componentDidMount(){
      this.timer = setInterval(()=>{
        this.setState({
        date:new Date()
      });
      },1000)
    }

    componentDidUnmount(){
      clearInterval(this.timer);
    }

    render (){
      return (
      <div>
        <h1>Hello, world!</h1>
        <h2>It is {this.state.date.toLocaleTimeString()}.</h2>
      </div>
      )
    }
  }

  
  ReactDOM.render(
    <Clock />,
    document.getElementById('root')
  );
  
```
